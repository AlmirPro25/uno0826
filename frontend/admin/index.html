<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROST-QS | Console Soberano</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        dark: '#0a0a12',
                        'dark-card': '#12121e',
                        'dark-border': '#1e1e2e',
                        'sovereign': '#dc2626'
                    }
                }
            }
        }
    </script>
    <style>
        body { background: #0a0a12; }
        .sidebar { background: linear-gradient(180deg, #12121e 0%, #0a0a12 100%); }
        .card { background: #12121e; border: 1px solid #1e1e2e; }
        .table-row:hover { background: rgba(99,102,241,0.05); }
        .nav-group-title { font-size: 10px; letter-spacing: 0.1em; }
        .killswitch-active { animation: pulse-red 2s infinite; }
        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
        }
    </style>
</head>
<body class="min-h-screen text-white flex">
    <!-- Loader -->
    <div id="loader" class="fixed inset-0 bg-dark z-50 flex items-center justify-center hidden">
        <div class="text-center">
            <div class="w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-gray-400">Carregando...</p>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast-container" class="fixed top-4 right-4 z-50"></div>

    <!-- Kill Switch Global Banner -->
    <div id="killswitch-banner" class="fixed top-0 left-0 right-0 bg-red-600 text-white py-2 px-4 text-center z-40 hidden">
        <i class="fas fa-exclamation-triangle mr-2"></i>
        <span id="killswitch-banner-text">KILL SWITCH ATIVO</span>
        <button onclick="showSection('killswitch')" class="ml-4 underline">Ver detalhes</button>
    </div>

    <!-- ========== LOGIN PAGE ========== -->
    <div id="login-page" class="min-h-screen w-full flex items-center justify-center">
        <div class="w-full max-w-md p-6">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-sovereign/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-crown text-3xl text-sovereign"></i>
                </div>
                <h1 class="text-2xl font-bold">Console Soberano</h1>
                <p class="text-gray-400 mt-2">PROST-QS Governance Center</p>
            </div>

            <form id="login-form" class="card rounded-2xl p-6">
                <div class="mb-4">
                    <label class="block text-sm text-gray-400 mb-2">Username</label>
                    <input type="text" id="username-input" placeholder="admin" 
                        class="w-full bg-dark border border-dark-border rounded-xl px-4 py-3 text-white focus:border-primary outline-none">
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-gray-400 mb-2">Password</label>
                    <input type="password" id="password-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                        class="w-full bg-dark border border-dark-border rounded-xl px-4 py-3 text-white focus:border-primary outline-none">
                </div>
                <button type="submit" class="w-full bg-sovereign hover:bg-red-700 text-white font-bold py-3 rounded-xl transition-all">
                    <i class="fas fa-shield-halved mr-2"></i> Acessar Console
                </button>
                <div class="mt-4 pt-4 border-t border-dark-border">
                    <p class="text-xs text-gray-500 mb-2">Ou entre com token JWT:</p>
                    <input type="text" id="token-input" placeholder="Cole seu token JWT aqui" 
                        class="w-full bg-dark border border-dark-border rounded-xl px-4 py-2 text-white text-xs focus:border-primary outline-none mb-2">
                    <button type="button" onclick="loginWithToken()" class="w-full bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-xl text-sm">
                        Entrar com Token
                    </button>
                </div>
            </form>
            <p class="text-center text-gray-500 text-xs mt-4">Acesso restrito a administradores autorizados</p>
        </div>
    </div>

    <!-- ========== MAIN LAYOUT ========== -->
    <div id="main-layout" class="flex w-full hidden">
        <!-- Sidebar -->
        <aside class="sidebar w-72 min-h-screen border-r border-dark-border flex flex-col overflow-y-auto">
            <div class="p-6 border-b border-dark-border">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-sovereign/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-crown text-sovereign"></i>
                    </div>
                    <div>
                        <h1 class="font-bold">PROST-QS</h1>
                        <p class="text-xs text-gray-500">Console Soberano</p>
                    </div>
                </div>
            </div>

            <nav class="flex-1 p-4 space-y-6">
                <!-- OVERVIEW -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Overview</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('dashboard')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="dashboard">
                                <i class="fas fa-chart-line w-5 text-gray-400"></i> Dashboard
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('crisis')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="crisis">
                                <i class="fas fa-exclamation-circle w-5 text-red-400"></i> Crisis View
                                <span id="crisis-badge" class="ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full hidden">!</span>
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('health')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="health">
                                <i class="fas fa-heartbeat w-5 text-emerald-400"></i> System Health
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- IDENTITY -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Identity</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('users')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="users">
                                <i class="fas fa-users w-5 text-gray-400"></i> Usu√°rios
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('subscriptions')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="subscriptions">
                                <i class="fas fa-id-card w-5 text-gray-400"></i> Subscriptions
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- ECONOMY -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Economy</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('billing')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="billing">
                                <i class="fas fa-credit-card w-5 text-gray-400"></i> Billing
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('ledger')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="ledger">
                                <i class="fas fa-coins w-5 text-gray-400"></i> Ledger
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- GOVERNANCE -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Governance</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('killswitch')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="killswitch">
                                <i class="fas fa-power-off w-5 text-red-400"></i> Kill Switch
                                <span id="ks-badge" class="ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full hidden">!</span>
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('policies')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="policies">
                                <i class="fas fa-gavel w-5 text-gray-400"></i> Policies
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('approvals')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="approvals">
                                <i class="fas fa-check-double w-5 text-gray-400"></i> Approvals
                                <span id="approvals-badge" class="ml-auto bg-amber-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('authority')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="authority">
                                <i class="fas fa-user-shield w-5 text-gray-400"></i> Authority
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- COGNITIVE (Fase 26.5) -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">üß† Cognitive</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('cognitive')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="cognitive">
                                <i class="fas fa-eye w-5 text-cyan-400"></i> Dashboard Cognitivo
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('cognitive-agents')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="cognitive-agents">
                                <i class="fas fa-robot w-5 text-purple-400"></i> Agentes
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('cognitive-decisions')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="cognitive-decisions">
                                <i class="fas fa-gavel w-5 text-amber-400"></i> Decis√µes
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('cognitive-noise')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="cognitive-noise">
                                <i class="fas fa-volume-mute w-5 text-rose-400"></i> Ru√≠do
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('cognitive-trust')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="cognitive-trust">
                                <i class="fas fa-chart-line w-5 text-emerald-400"></i> Confian√ßa
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- AGENTS -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Agents</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('autonomy')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="autonomy">
                                <i class="fas fa-robot w-5 text-gray-400"></i> Autonomy Matrix
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('shadow')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="shadow">
                                <i class="fas fa-ghost w-5 text-gray-400"></i> Shadow Mode
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('agents')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="agents">
                                <i class="fas fa-brain w-5 text-gray-400"></i> Agent Decisions
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- MEMORY -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">Memory</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('memory')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="memory">
                                <i class="fas fa-database w-5 text-gray-400"></i> Institutional Memory
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('audit')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="audit">
                                <i class="fas fa-scroll w-5 text-gray-400"></i> Audit Log
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- SYSTEM -->
                <div>
                    <p class="nav-group-title text-gray-500 uppercase mb-2 px-4">System</p>
                    <ul class="space-y-1">
                        <li>
                            <button onclick="showSection('applications')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="applications">
                                <i class="fas fa-cube w-5 text-blue-400"></i> Applications
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('login-history')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="login-history">
                                <i class="fas fa-sign-in-alt w-5 text-emerald-400"></i> Login History
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('financial')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="financial">
                                <i class="fas fa-chart-pie w-5 text-emerald-400"></i> Financial
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('reconciliation')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="reconciliation">
                                <i class="fas fa-balance-scale w-5 text-cyan-400"></i> Reconciliation
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('alerts')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="alerts">
                                <i class="fas fa-bell w-5 text-amber-400"></i> Alerts
                                <span id="alerts-badge" class="ml-auto bg-rose-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('kernel-billing')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="kernel-billing">
                                <i class="fas fa-money-bill-wave w-5 text-emerald-400"></i> Kernel Billing
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('jobs')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-left hover:bg-white/5 transition-all text-sm" data-section="jobs">
                                <i class="fas fa-cogs w-5 text-gray-400"></i> Jobs
                            </button>
                        </li>
                    </ul>
                </div>
            </nav>

            <div class="p-4 border-t border-dark-border">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-sovereign/20 rounded-full flex items-center justify-center">
                        <i class="fas fa-crown text-sovereign"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p id="admin-name" class="font-medium truncate">Admin</p>
                        <p id="admin-role" class="text-xs text-gray-500">Super Admin</p>
                    </div>
                </div>
                <button onclick="logout()" class="w-full bg-sovereign/20 text-sovereign py-2 rounded-xl hover:bg-sovereign/30 transition-all text-sm">
                    <i class="fas fa-sign-out-alt mr-2"></i> Sair
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-auto">
            <!-- Header -->
            <header class="border-b border-dark-border px-8 py-4 flex items-center justify-between sticky top-0 bg-dark z-10">
                <h2 id="section-title" class="text-xl font-bold">Dashboard</h2>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-400" id="last-update">Atualizado agora</span>
                    <button onclick="refreshData()" class="bg-white/5 hover:bg-white/10 px-4 py-2 rounded-xl transition-all">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="p-8" id="content-area">
                <!-- Sections will be loaded here -->
            </div>
        </main>
    </div>

    <script src="src/main.js"></script>
    <script src="src/cognitive.js"></script>
    <script src="src/applications.js"></script>
    <script src="src/identity.js"></script>
    <script src="src/financial.js"></script>
    <script src="src/kernel_billing.js"></script>
</body>
</html>
